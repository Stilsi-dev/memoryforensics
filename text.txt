pip install yara-python volatility3

python memory_analyzer.py -f memory.DMP -o report.txt



NEED TO UPDATE

- remove the limit 10

- ADD THE SUGGESTIONS

Process Ranking:

You could prioritize suspicious processes in a more structured way, like adding a severity ranking (e.g., "Critical", "High", "Low").

Suspicious DLLs:

Consider logging all suspicious DLLs in the report with their full paths, rather than just flagging them for the processes. This might provide more actionable information for incident responders.

Add User Context:

It might be useful to add user context to each process if available (e.g., which user the process belongs to). This could help in identifying unauthorized users or processes running under a suspicious user context.

Automated File Hashing:

For processes flagged as suspicious, hash the associated files (if available) and look them up on VirusTotal or another service to confirm if they are known malware.

Potential Malware Families:

If you identify malware based on YARA rule matches, try to categorize the malware by families or groups (e.g., “Mimikatz”, “Cobalt Strike”).


- CSV NOT WORKING

PS C:\Users\Juls Nuque\Documents\GitHub\memoryforensics-group2>
 python memory_analyzer.py -f memdump.mem --report-type csv
>>

============================================================   
MEMORY FORENSIC ANALYZER - VOLATILITY 3 VERSION
============================================================   

[+] Successfully loaded YARA rules from malware_rules.yar      
[+] Extracting visible processes (pslist)...
[+] Extracting all processes (psscan)...
[+] Checking for suspicious DLLs...
  [*] Checking DLLs for PID 788 (svchost.exe)...
  [*] Checking DLLs for PID 2616 (reader_sl.exe)...
  [*] Checking DLLs for PID 4 (System)...
  [*] Checking DLLs for PID 832 (TPAutoConnSvc.e)...
  [*] Checking DLLs for PID 2720 (Oobe.exe)...
  [*] Checking DLLs for PID 2352 (taskeng.exe)...
  [*] Checking DLLs for PID 2368 (userinit.exe)...
  [*] Checking DLLs for PID 2392 (dwm.exe)...
  [*] Checking DLLs for PID 2496 (explorer.exe)...
  [*] Checking DLLs for PID 2480 (TPAutoConnect.e)...
  [*] Checking DLLs for PID 2580 (vmtoolsd.exe)...
  [*] Checking DLLs for PID 2592 (AdobeARM.exe)...
  [*] Checking DLLs for PID 3920 (notepad.exe)...
  [*] Checking DLLs for PID 3224 (svchost.exe)...
  [*] Checking DLLs for PID 3336 (iashost.exe)...
  [*] Checking DLLs for PID 1800 (FTK)...
  [*] Checking DLLs for PID 1640 (vmtoolsd.exe)...
  [*] Checking DLLs for PID 1696 (svchost.exe)...
  [*] Checking DLLs for PID 2096 (taskeng.exe)...
  [*] Checking DLLs for PID 1924 (dllhost.exe)...
  [*] Checking DLLs for PID 1572 (msdtc.exe)...
  [*] Checking DLLs for PID 3680 (wuauclt.exe)...
  [*] Checking DLLs for PID 2708 (notepad.exe)...
  [*] Checking DLLs for PID 1888 (iexplore.exe)...
  [*] Checking DLLs for PID 884 (svchost.exe)...
  [*] Checking DLLs for PID 976 (svchost.exe)...
  [*] Checking DLLs for PID 1000 (svchost.exe)...
  [*] Checking DLLs for PID 1056 (SLsvc.exe)...
  [*] Checking DLLs for PID 1088 (svchost.exe)...
  [*] Checking DLLs for PID 1160 (svchost.exe)...
  [*] Checking DLLs for PID 1188 (svchost.exe)...
  [*] Checking DLLs for PID 1308 (svchost.exe)...
  [*] Checking DLLs for PID 1424 (spoolsv.exe)...
  [*] Checking DLLs for PID 1460 (armsvc.exe)...
  [*] Checking DLLs for PID 1480 (dns.exe)...
  [*] Checking DLLs for PID 1508 (ftpbasicsvr.exe)...
  [*] Checking DLLs for PID 1576 (svchost.exe)...
  [*] Checking DLLs for PID 1620 (snmp.exe)...
  [*] Checking DLLs for PID 1604 (svchost.exe)...
  [*] Checking DLLs for PID 516 (csrss.exe)...
  [*] Checking DLLs for PID 524 (wininit.exe)...
  [*] Checking DLLs for PID 552 (winlogon.exe)...
  [*] Checking DLLs for PID 616 (lsass.exe)...
  [*] Checking DLLs for PID 624 (lsm.exe)...
  [*] Checking DLLs for PID 404 (smss.exe)...
  [*] Checking DLLs for PID 472 (csrss.exe)...
  [*] Checking DLLs for PID 848 (svchost.exe)...
  [*] Checking DLLs for PID 604 (services.exe)...
[+] Scanning process memory with YARA rules (limit: 10)...
  [*] Scanning PID 788 (svchost.exe)...
    [!] Found 2 YARA matches
  [*] Scanning PID 2616 (reader_sl.exe)...
    [!] Found 2 YARA matches
  [*] Scanning PID 4 (System)...
    [!] Found 2 YARA matches
  [*] Scanning PID 832 (TPAutoConnSvc.e)...
    [!] Found 2 YARA matches
  [*] Scanning PID 2720 (Oobe.exe)...
    [!] Found 2 YARA matches
  [*] Scanning PID 2352 (taskeng.exe)...
    [!] Found 2 YARA matches
  [*] Scanning PID 2368 (userinit.exe)...
    [!] Found 2 YARA matches
  [*] Scanning PID 2392 (dwm.exe)...
    [!] Found 2 YARA matches
  [*] Scanning PID 2496 (explorer.exe)...
    [!] Found 4 YARA matches
  [*] Scanning PID 2480 (TPAutoConnect.e)...
    [!] Found 3 YARA matches
[+] Generating report: analysis\analysisReport_006.txt
Traceback (most recent call last):
  File "C:\Users\Juls Nuque\Documents\GitHub\memoryforensics-group2\memory_analyzer.py", line 317, in <module>
    main()
  File "C:\Users\Juls Nuque\Documents\GitHub\memoryforensics-group2\memory_analyzer.py", line 306, in main
    analyzer.generate_report({
  File "C:\Users\Juls Nuque\Documents\GitHub\memoryforensics-group2\memory_analyzer.py", line 262, in generate_report
    writer.writerow(p)
  File "C:\Users\Juls Nuque\AppData\Local\Programs\Python\Python312\Lib\csv.py", line 164, in writerow
    return self.writer.writerow(self._dict_to_list(rowdict))   
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^    
  File "C:\Users\Juls Nuque\AppData\Local\Programs\Python\Python312\Lib\csv.py", line 159, in _dict_to_list
    raise ValueError("dict contains fields not in fieldnames: "
ValueError: dict contains fields not in fieldnames: 'PPID', 'Hidden'
PS C:\Users\Juls Nuque\Documents\GitHub\memoryforensics-group2>
