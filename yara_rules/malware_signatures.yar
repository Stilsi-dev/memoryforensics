rule CobaltStrike_Beacon {
    meta:
        description = "Detects Cobalt Strike beacon"
        reference = "https://attack.mitre.org/software/S0154/"
    
    strings:
        $beacon_config = { 00 00 00 00 ?? ?? ?? ?? ?? ?? ?? ?? 00 00 00 00 [4-8] 00 00 00 00 }
        $beacon_string1 = "beacon.dll" ascii wide
        $beacon_string2 = "beacon.x64.dll" ascii wide
    
    condition:
        any of them
}

rule Mimikatz {
    meta:
        description = "Detects Mimikatz components"
        reference = "https://attack.mitre.org/software/S0002/"
    
    strings:
        $mimikatz_string1 = "mimikatz" ascii wide nocase
        $mimikatz_string2 = "sekurlsa::logonpasswords" ascii
        $mimikatz_string3 = "kerberos::ptt" ascii
    
    condition:
        2 of them
}